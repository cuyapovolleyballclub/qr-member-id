<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cuyapo Member Portal</title>

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", Arial, sans-serif;
}

body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(135deg, #0f7d4c, #1fa66a);
  display: flex;
  justify-content: center;
  align-items: center;
}

.card {
  background: #fff;
  width: 380px;
  padding: 35px;
  border-radius: 10px;
  box-shadow: 0 15px 40px rgba(0,0,0,.25);
  text-align: center;
}

.logos {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-bottom: 15px;
}

.logos img {
  height: 55px;
}

h2 {
  color: #0f7d4c;
  margin-bottom: 5px;
}

.subtitle {
  font-size: 13px;
  color: #666;
  margin-bottom: 25px;
}

input {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

input:focus {
  outline: none;
  border-color: #1fa66a;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 5px;
  border: none;
  border-radius: 5px;
  background: #0f7d4c;
  color: white;
  font-size: 15px;
  cursor: pointer;
}

button.secondary {
  background: #1fa66a;
}

button:hover {
  opacity: .9;
}

#msg {
  margin-top: 15px;
  font-size: 13px;
  color: #cc0000;
}

#dashboard h3 {
  color: #0f7d4c;
}

#uid {
  font-weight: bold;
  word-break: break-all;
  background: #f4f4f4;
  padding: 10px;
  border-radius: 5px;
  margin-bottom: 20px;
  font-size: 13px;
}
</style>
</head>

<body>

<div class="card">

  <div class="logos">
    <img src="ucu-logo.png" alt="UCU Logo">
    <img src="cvc-logo.png" alt="CVC Logo">
  </div>

  <h2>Cuyapo Member Portal</h2>
  <div class="subtitle">
    CVC â€” Cuyapo Volleyball Club<br>
    Inspired by Urdaneta City University
  </div>

  <!-- AUTH -->
  <div id="auth">
    <input id="email" placeholder="Email address">
    <input id="password" type="password" placeholder="Password">

    <button onclick="login()">Login</button>
    <button class="secondary" onclick="register()">Register</button>

    <p id="msg"></p>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" style="display:none;">
    <h3>Welcome, Member!</h3>
    <p>Your Member ID (QR-ready)</p>
    <div id="uid"></div>
    <button onclick="logout()">Logout</button>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBHGC9xcl9H5dHmBsCRfmGcxY-wrNWJgVc",
  authDomain: "cuyapo-member-portal.firebaseapp.com",
  projectId: "cuyapo-member-portal",
  storageBucket: "cuyapo-member-portal.firebasestorage.app",
  messagingSenderId: "618744547531",
  appId: "1:618744547531:web:d710db73a6024de326334e"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const email = document.getElementById("email");
const password = document.getElementById("password");
const msg = document.getElementById("msg");
const authDiv = document.getElementById("auth");
const dash = document.getElementById("dashboard");
const uidDiv = document.getElementById("uid");

window.register = async () => {
  try {
    const cred = await createUserWithEmailAndPassword(auth, email.value, password.value);
    await setDoc(doc(db, "members", cred.user.uid), {
      email: email.value,
      createdAt: new Date()
    });
    msg.style.color = "green";
    msg.textContent = "Registered successfully. You may now login.";
  } catch (e) {
    msg.style.color = "red";
    msg.textContent = e.message;
  }
};

window.login = async () => {
  try {
    await signInWithEmailAndPassword(auth, email.value, password.value);
  } catch (e) {
    msg.style.color = "red";
    msg.textContent = e.message;
  }
};

window.logout = () => signOut(auth);

onAuthStateChanged(auth, user => {
  if (user) {
    authDiv.style.display = "none";
    dash.style.display = "block";
    uidDiv.textContent = user.uid;
  } else {
    authDiv.style.display = "block";
    dash.style.display = "none";
  }
});
</script>

</body>
</html>
